<div th:fragment="content">

  <div class="d-flex align-items-center gap-2 mt-2 mb-3">
    <a class="btn btn-outline-secondary"
       th:href="@{/week(date=${prevWeekDate})}">← Prev week</a>

    <h2 class="flex-grow-1 text-center mb-0" th:text="${weekHeadline}">Week X</h2>

    <span th:if="${nextDisabled}" class="btn btn-outline-secondary disabled"
          aria-disabled="true" tabindex="-1">Next week →</span>
    <a th:if="${!nextDisabled}" class="btn btn-outline-secondary"
       th:href="@{/week(date=${nextWeekDate})}">Next week →</a>

    <a class="btn btn-outline-primary" th:href="@{/week}">This week</a>
  </div>

  <table class="table">
    <thead>
    <tr>
      <th>Habits</th>
      <th th:each="d : ${weekDays}"
          class="text-center"
          th:text="${#temporals.format(d, 'E')}">
        Mon
      </th>
    </tr>
    </thead>

    <tbody>

      <tr th:each="h : ${habits}">
        <th th:text="${h.name}"></th>

        <td th:each="day : ${weekDays}" class="text-center">
          <input type="checkbox"
                 class="form-check-input"
                 th:data-id="${h.id}"
                 th:data-date="${#temporals.format(day, 'yyyy-MM-dd')}"
                 th:checked="${habitWeekStatus.get(h.id)?.get(day)}"
                 onchange="toggleHabitDoneAtDate(this)" />
        </td>
      </tr>


    </tbody>
  </table>

  <!-- navigating with keyboard arrow buttons :D (←/→) -->
  <script th:inline="javascript">
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') {
        window.location.href = /*[[@{/week(date=${prevWeekDate})}]]*/ '#';
      }
      if (e.key === 'ArrowRight') {
        const nextDisabled = /*[[${nextDisabled}]]*/ true;
        if (!nextDisabled) {
          window.location.href = /*[[@{/week(date=${nextWeekDate})}]]*/ '#';
        }
      }
    });
  </script>

</div>
